<%- include('layout') %>

<style>
    .profile-page {
  display: flex;
  justify-content: center;
  padding: 4rem 1rem;
  background: var(--container-bg);
}

.profile-card {
  background: var(--body-bg);
  padding: 2rem;
  border-radius: 1.5rem;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
  max-width: 600px;
  width: 100%;
}

.avatar-wrapper {
  position: relative;
  width: 120px;
  height: 120px;
  border-radius: 50%;
  overflow: hidden;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
}

.profile-pic {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  z-index: 0;
}

.edit-icon {
  position: absolute;
  bottom: 5px;
  right: 5px;
  background: var(--primary-color);
  color: var(--button-text);
  border-radius: 50%;
  padding: 6px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: background 0.3s ease;
  z-index: 10;
}

.edit-icon:hover {
  background: var(--secondary-color);
}

.avatar-wrapper:hover::after {
  content: "";
  position: absolute;
  top: 0; left: 0; bottom: 0; right: 0;
  background: rgba(0,0,0,0.2);
}


.avatar-selector-wrapper {
  margin: 2rem auto;
  max-width: 90%;
  text-align: center;
}

.carousel-container {
  position: relative;
  overflow: hidden;
}

.center-highlight {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  width: 120px;
  height: 120px;
  transform: translateX(-50%);
  border-radius: 50%;
  z-index: 10;
  pointer-events: none;
  box-shadow: 0 0 10px var(--primary-color);
}

.avatar-carousel {
  display: flex;
  overflow-x: auto;
  gap: 1.5rem;
  scroll-behavior: smooth;
  padding: 1rem 0;
  scroll-snap-type: x mandatory;
  scrollbar-width: none;
}
.avatar-carousel::-webkit-scrollbar {
  display: none;
}

.avatar-item.spacer {
  width: calc(18vw - 45px); /* 45px is half the avatar width (90px) */
  height: 90px;
  pointer-events: none;
  opacity: 0;
}


.avatar-item {
  flex: 0 0 auto;
  width: 90px;
  height: 90px;
  border-radius: 50%;
  overflow: hidden;
  scroll-snap-align: center;
  position: relative;
  transition: all 0.3s ease;
  transform: scale(0.7);
  opacity: 0.4;
}

.avatar-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

.avatar-item.active {
  transform: scale(1.2);
  opacity: 1;
  z-index: 5;
}



.upload-btn {
  display: inline-block;
  margin-top: 0.5rem;
  background: var(--primary-color);
  color: var(--button-text);
  padding: 0.4rem 1rem;
  font-size: 0.9rem;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.3s ease;
}

.upload-btn:hover {
  background: var(--primary-hover);
}

.info-section h2 {
  font-size: 1.5rem;
  color: var(--text-color);
  margin-bottom: 0.5rem;
}

.bio {
  font-size: 0.95rem;
  color: var(--muted-text);
  margin-bottom: 1.5rem;
  text-align: center;
}

.profile-form .form-group {
  margin-bottom: 1.2rem;
}

.profile-form label {
  display: block;
  margin-bottom: 0.4rem;
  color: var(--text-color);
  font-size: 0.9rem;
}

.profile-form input,
.profile-form textarea {
  width: 100%;
  padding: 0.6rem;
  border: 1px solid var(--text-color);
  border-radius: 0.6rem;
  background: var(--input-bg);
  color: var(--text-color);
  font-size: 0.95rem;
}

.profile-form textarea {
  resize: vertical;
  min-height: 100px;
}

.save-btn {
  background: var(--primary-color);
  color: var(--button-text);
  padding: 0.6rem 1.2rem;
  border: none;
  border-radius: 0.6rem;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s ease;
}

.save-btn:hover {
  background: var(--primary-hover);
}

</style>

  <body>
    <div class="jumbotron text-center">
      <div class="container">
        <section class="profile-page">
            <div class="profile-card">
              <div class="avatar-wrapper">
                <img src="<%= profile.profile_picture %>" alt="User Avatar" class="profile-pic" />
                <label for="avatar-upload" class="edit-icon">
                  <i class="fas fa-pen"></i>
                </label>
                <input type="file" id="avatar-upload" accept="image/*" style="display: none;" />
              </div>

              <div class="avatar-selector-wrapper">
                <h3 class="display-3">Select Your Avatar</h3>
                <div class="carousel-container">
                  <div class="center-highlight"></div>
                  <div class="avatar-carousel" id="avatarCarousel">
                    <div class="avatar-item spacer"></div> <!-- before -->
                    

                    <div class="avatar-item"><img src="./img/avatars/thumbs/dog.jpg" alt="Dog" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/carmel.jpg" alt="Carmel" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/monkey.jpg" alt="Monkey" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/elephant.jpg" alt="Elephant" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/bird.jpg" alt="Bird" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/carmel.jpg" alt="Carmel" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/lioness.jpg" alt="Lioness" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/cute dog.jpg" alt="Dog" /></div>
                    <div class="avatar-item active"><img src="./img/avatars/thumbs/girrafe.jpg" alt="Girrafe" /></div>
                    <div class="avatar-item"><img src="./img/avatars/thumbs/sheep.jpg" alt="Sheep" /></div>
                    <!-- Add more avatars -->
                
                    <div class="avatar-item spacer"></div> <!-- after -->
                  </div>
                </div>
                
              </div>
              
              
              
          
              <div class="info-section">
                <h2>@amebo<%= userId %></h2>
                <p class="bio">Your short bio goes here...</p>
          
                <form class="profile-form">
                  <div class="form-group">
                    <label for="displayName">Display Name</label>
                    <input type="text" id="displayName" value="John Doe" />
                  </div>
                  <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" value="john@example.com" />
                  </div>
                  <div class="form-group">
                    <label for="bio">Bio</label>
                    <textarea id="bio">Tell us about yourself...</textarea>
                  </div>
          
                  <button type="submit" class="save-btn">Save Changes</button>
                </form>
              </div>
            </div>
          </section>
          
      </div>
      </div>
      <script>
        const carousel = document.getElementById('avatarCarousel');
        const avatarItems = document.querySelectorAll('.avatar-item');
      
        function updateCenterSelection() {
  let closest = null;
  let closestDistance = Infinity;

  document.querySelectorAll('.avatar-item:not(.spacer)').forEach(item => {
    const rect = item.getBoundingClientRect();
    const centerX = window.innerWidth / 2;
    const itemCenter = rect.left + rect.width / 2;
    const distance = Math.abs(centerX - itemCenter);

    if (distance < closestDistance) {
      closestDistance = distance;
      closest = item;
    }
  });

  document.querySelectorAll('.avatar-item').forEach(item =>
    item.classList.remove('active')
  );
  if (closest) closest.classList.add('active');
}

      
        function scrollToCenter(element) {
          const carouselRect = carousel.getBoundingClientRect();
          const elementRect = element.getBoundingClientRect();
          const offset = (elementRect.left + elementRect.width / 2) - (carouselRect.left + carouselRect.width / 2);
          carousel.scrollBy({ left: offset, behavior: 'smooth' });
        }
      
        avatarItems.forEach(item => {
          item.addEventListener('click', () => {
            scrollToCenter(item);
          });
        });
      
        carousel.addEventListener('scroll', () => {
          window.requestAnimationFrame(updateCenterSelection);
        });
      
        // Initial call
        updateCenterSelection();
      </script>
      
      

      <script>
        const avatarInput = document.getElementById('avatar-upload');
        const avatarImg = document.querySelector('.profile-pic');
      
        avatarInput.addEventListener('change', function () {
          const file = this.files[0];
          if (file) {
            const reader = new FileReader();
      
            reader.onload = function (e) {
              avatarImg.src = e.target.result;
            }
      
            reader.readAsDataURL(file);
          }
        });
      </script>
      
      <script>
        const header = document.querySelector('header');
        const nextSection = document.querySelector('body').querySelector('section:not(.active)');
        const logo = document.getElementById('logo')

        window.addEventListener('scroll', function () {
            const scrolled = window.scrollY > 0;
            if (scrolled) {
                let body = document.querySelector('body');
                body.style.overflowY = 'scroll';
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
    </script>

    <script>
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.addEventListener('click', function (e) {
          e.preventDefault();
          showBrandLogo();

          setTimeout(() => {
            window.location.href = this.formAction;
          }, 2400); // give animation time to play
        });
      });

    </script>
    <script>
      document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function (e) {
          e.preventDefault();
          showBrandLogo();

          setTimeout(() => {
            window.location.href = this.href;
          }, 2400); // give animation time to play
        });
      });
    </script>


    <script src="/js/app.js"></script>
    <script src="/js/defaultTheme.js"></script>
    <script src="/js/tutorial.js"></script>
    <script src="/js/generate-thumbnails.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.0/lottie.min.js"></script>
  </body>